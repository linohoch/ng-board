<div class="container">
  <div class="">
    <div *ngIf="isLoading$ | async">Loading...</div>
    <div class="contents-wrapper" *ngIf="detail$ | async as article">

      <div class="article-container">
        <div class="title-area">
          <div>{{article.no}}</div>
          <div class="title">{{article.title}}</div>
          <div>작성: {{calDate(article.insDate)}}</div>
        </div>
        <div class="sub-area">
          <div>{{article.userEmail}}</div>
          <div>
            <div>hit_cnt: {{article.hitCnt}}</div>
            <div class="like-cnt">like_cnt: {{article.likeCnt}}</div>
          </div>
        </div>
        <div class="article-area">
          <div id="contents">{{article.contents}}</div>
        </div>
        <div class="bottom-area">
          <div>shop_no {{article.no}}</div>
        </div>
        <div class="photo-container" *ngIf="article.photo">
            <div class="photo-block"
                 *ngFor="let url of article.photo" >
              <img src="{{url}}" alt="photo"/>
            </div>
        </div>
<!--        <div *ngIf="article.userEmail===me">-->
          <button (click)="goToEdit()"
                  [disabled]="article.userEmail!==me">edit</button>
          <button (click)="delete()"
                  [disabled]="article.userEmail!==me">delete</button>
<!--        </div>-->
        <div class="comment-area">
          <div class="comment-textarea-wrapper">
              <textarea class="comment-textarea"
                        placeholder="{{me?'':'댓글을 작성하려면 로그인하세요'}}"
                        #commentText
                        [attr.data-grp]="0"
                        [attr.data-seq]="0"
                        [attr.data-lv]="0"
                        [attr.data-parent]="0"
              ></textarea>
            <button class="lv1-comment-btn"
                    (click)="commentBtn(commentText)">comment</button>
            <button class="like-btn"
                    [disabled]="me===article.userEmail"
            >like</button>
            <button class="del-btn"
                    [disabled]="me!==article.userEmail"
                    (click)="delete()"
            >delete</button>
          </div>
        </div>
      </div>

      <div class="comment-container">
        <div>
          <div class="comment-list-container" *ngIf="!commentList$">
            댓글없다
          </div>
          <div class="comment-list-container" *ngIf="commentList$">
            <div>
              <div>댓글 {{(commentList$|async)?.length}}개</div>
            </div>

            <div class="comment lv"
                 id="c-{{comment.no}}"
                 style="--lv: {{comment.lv-1}}"
                 *ngFor="let comment of commentList$ | async; let index = index">
              <div class="indent-wrapper">
                <div class="line" *ngFor="let th of comment.thread; let i = index;"
                     (mouseover)="focusThread(th)"
                     (mouseout)="focusThread(0)"
                     (click)="foldThread(th)">
                  <i class="threadline{{focusedThread===th?'-hover':''}}"
                     [attr.data-no]="th"></i>
                </div>
              </div>
              <div class="comment-wrapper">
                <div class="comment-left">
                  <div class="unfold-button">
                    <button (click)="unfoldThread(comment.no)"> + </button>
                  </div>
                  <div class="profile-image">
                    <div>{{comment.userEmail?.charAt(0)}}</div>
                  </div>
                </div>
                <div class="comment-contents">
                  <div class="comment-header">
                    <div>{{comment.userEmail}}<div *ngIf="article.userEmail===comment.userEmail">[]</div></div>
                    <div>  ∙ {{calDate(comment.insDate)}}</div>
                    <div>[ {{comment.no}} ]</div>
                  </div>
                  <div class="comment-content">{{comment.contents}}</div>
                  <div class="button-wrapper">
                    <div>like: {{comment.likeCnt}}</div>
                    <button class="like-btn"
                            [attr.data-no]="comment.no"
                            [disabled]="me===comment.userEmail"
                            type="button"
                            (click)="likeCommentBtn()">like</button>
                    <button (click)="showTextareaBtn(inputComment)">comment</button>
                    <button class="delete-btn"
                            [attr.data-no]="comment.no"
                            [disabled]="me!==comment.userEmail"
                            type="button"
                            (click)="delCommentBtn(comment.no)">delete</button>
                  </div>
                  <div class="comment-textarea-wrapper">
                  <textarea class="comment-textarea"
                            placeholder="{{me?'':'댓글을 작성하려면 로그인하세요'}}"
                            #inputComment
                            [attr.data-grp]="comment.grp"
                            [attr.data-seq]="comment.seq"
                            [attr.data-lv]="comment.lv"
                            [attr.data-parent]="comment.no"></textarea>
                    <button class="comment-btn"
                            [disabled]="!me"
                            type="button"
                            (click)="commentBtn(inputComment)">comment</button>
                  </div>
                </div>
              </div>
            </div>

          </div>

        </div>

      </div>
      <div>
          bottom

      </div>

    </div>
  </div>
</div>
